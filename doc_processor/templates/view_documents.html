{% extends 'base.html' %}

{% block title %}View Documents for Batch {{ batch_id }}{% endblock %}

{% block content %}
<style>
    .doc-list-container { max-width: 900px; margin: auto; background-color: white; padding: 20px; border: 1px solid #ccc; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .doc-list-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    .doc-list-table th, .doc-list-table td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: middle; }
    .doc-list-table th { background-color: #f2f2f2; }
</style>

{% if documents %}
    {% if is_single_document_batch %}
        <div class="doc-list-container">
            <h1>ðŸ“„ Documents for Batch #{{ batch_id }}</h1>
            <table class="doc-list-table">
                <thead>
                    <tr>
                        <th>Original Filename</th>
                        <th>Category</th>
                        <th>Final Filename</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for doc in documents %}
                    <tr>
                        <td>{{ doc.original_filename }}</td>
                        <td>{{ doc.category }}</td>
                        <td>{{ doc.filename }}</td>
                        <td>
                            {% if doc.searchable_pdf_path %}
                            <a href="{{ url_for('export.serve_processed_file', filepath='searchable_pdfs/' + doc.original_filename.replace('.pdf', '_searchable.pdf')) }}" target="_blank"{{ testid('view-pdf-'+doc.id|string) }}>ðŸ“„ View PDF</a>
                            {% else %}
                            <span style="color: #999;">PDF not available</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div>Traditional batch view (not yet implemented for single document batches)</div>
    {% endif %}
{% else %}
    <div style="text-align:center; color:#888; margin:40px 0;">No documents found for this batch.</div>
{% endif %}

<div style="padding: 24px 0 0 0; text-align: center;">
    <a href="{{ url_for('batch.batch_control') }}" style="min-width: 180px; background-color: #6c757d; color: white; border-radius: 5px; padding: 10px 20px; text-decoration: none; display: inline-block;"{{ testid('back-to-batch-control') }}>Back to Batch Control</a>
</div>
{% endblock %}
